{% extends 'base.html' %}
{% block content %}
  <div class="job-card">
    <div class="card-header">
      <a href="{% url 'jobs_detail' pk=job.id%}">
        {{job.job_title}}
      </a>
    </div>
    <div class="card-body">{{job.description}}</div>
    <div class="card-footer">{{job.reward}}</div>
  </div>

{% if user.is_authenticated and user.id != job.client.id %}
  {% if user == job.freelancer and not job.is_finished %}
    <form action="{% url 'upload' pk=job.id%}" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="file" name="file" required>
        <button type="submit">Send file</button>
    </form>
  {% endif %}
  {% if user_have_requested %}
  <form action="{% url 'delete_request' pk=job.id%}" method="POST">
    {% csrf_token %}
    <button type="submit">Cancel Request</button>
  </form>
  {% else %}
  <form action="{% url 'send_request' pk=job.id%}" method="POST">
    {% csrf_token %}
    <button type="submit">Request To Work</button>
  </form>
  {% endif %}

{% endif %}
{% if user.is_authenticated and user.id == job.client.id %}
  {% for work_request in work_requests %}
    <div class="request-card">
      <div class="card-header">
        <p>From: {{work_request.freelancer}}</p>
      </div>
      <form action="{% url 'accept_request' pk=work_request.id %}" method="POST">
        {% csrf_token %}
        <button type="submit">Accept</button>
      </form>
      <form action="{% url 'decline_request' pk=work_request.id %}" method="POST">
        {% csrf_token %}
        <button type="submit">Decline</button>
      </form>
    </div>
  {% endfor %}
  {% if job.is_finished %}
    <form action="{% url 'download' job.id %}" method="POST">
        {% csrf_token %}
        {{job.file}}
        <button type="submit">Download file</button>
    </form>
  {% endif %}
  <form action="{% url 'jobs_delete' pk=job.id%}" method="POST">
    {% csrf_token %}
    <button type="submit">Delete Job</button>
  </form>
{% endif %}


  
{% endblock %}